# TCAD - templated CAD, full 3D CAD in source code

See updates at the bottom!
==========================

- (1) C++ templates
- (2) As simple as all STLs
- (3) All in front of you, no first-, second- or third-party libs, no millions of foreign dlls
- (4) Interface is simple, mostly one-line code (see main.cpp with examples)
- (5) Easy debugging, heavily commented
- (6) Free to change

The plan :
- point (done)
- curves (done)
- surfaces (done)
- volumes (done)
- FFD (done)
- blocks (<B>doing...</B>)

<B>to do</B>
- intersections, maybe implicit
- booleans, maybe implicit
- 3D mesh
- level sets
- finite elements
- GUI?

Files
=====

- toperations.h - highest level, simplest in use

- tbasecurve.h  - curves, abstract class
- curves themselves
    - tlsqsegment.h         - low-power poly generated by plain LSQ
    - torthosegment.h       - segment based on Jacobi ortho poly
    - tbeziersegment.h      - Bezier segment
    - tbeziercurve.h        - Bezier curve (collection of Bezier segments)
    - tpointcurve.h         - piecewise linear curve of points
    - tsplinecurve.h        - B-spline curve
    
- tbasesurface.h  - surfaces, abstract class
- surfaces themselves
    - tbezierpatch.h        - single Bezier patch
    - tpointsurface.h       - point surface (a regular net of straight-line segments)
    - tbeziersurface.h      - Bezier surface (regular composite of Bezier patches)
    - tsplinesurface.h      - B-spline surface, polynomial

- tbasevolume.h  - volumes, abstract class
    - tbeziervolume.h       - volume on Bezier basis, uniform parameterisation
    - tsplinevolume.h       - volume on B-spline basis
    
- FFD.h                     - full FFD operation : distort shapes by setting point displacements

- tedge.h                   - edges for solid model
- tsolid.h                  - make edges and vertices for a solid model from surfaces and boundary loops

"How to" examples in main.cpp :
===============================

Point
=====

  tpoint.h                  - 3-dimensional vector (0 parametric dimensions) point with ariphmetic operations

Curves
======

Curves of various kinds, parametric, dependent of one parameter U. Most operations are linearised. 
Some operations are n-squared (yet).

<B>Example code how to use</B><br />

- 1.1 Curves : how to exclude neighbour duplicate nodes
- 1.2 Curves : compare original points and low-power LSQ segment, do not expecta good correspondence - 
  the lsq is a simple poly of power 3
- 1.3 Curves : compare points and Bezier segment, do not expect a good correspondence - Bezier segment is qubic
- 1.4 Curves : compare points and segment of orthogonal polynomials of degree 4. Starting END_ROUNDED 
  end is set to handle the round LE
- 1.5 Curves : compare points and Bezier curve (collection of Bezier segments)
- 1.6 Curves : compare points and approximated b-spline
- 1.7 Curves : compare points and approximated b-spline with less number of control points (10 here)
- 1.8 Curves : how to smooth a curve (curve2 below) with various approximants<br />
![Curve smoothed by spline](https://github.com/AndreyKoudr/TCAD/blob/master/Curve_smoothed_by_spline.png)
- 1.9 Curves : how to diminish effect of smoothing near curve ends (much needed when handling surface control points)
- 1.10 Curves : how to find parameter U for a point on curve
- 1.11 Curves : how to intersect by plane
- 1.12 Curves : how to intersect two curves
- 1.13 Curves : cut a piece of curve from the previous example
- 1.14 Curves : order unordered points<br />
![Ordered points](https://github.com/AndreyKoudr/TCAD/blob/master/Ordered_points.png)

Surfaces
========

<B>Example code how to use</B><br />

- 2.1 Surfaces : triangles : save in STL
- 2.2 Surfaces : triangles : manifold? solid?
- 2.3 Surfaces : triangles : cut by plane
- 2.4 Surfaces : triangles : how to find a sharpest point in intersection curve
- 2.5 Surfaces : triangles : how to get triangulation boundary<br />
![Fuselage boundary](https://github.com/AndreyKoudr/TCAD/blob/master/Fuselage_boundary.png)
- 2.6 Surfaces : triangles : more complicated cases, load STL, check if manifold and solid, generate boundary and cut by plane<br />
![Shuttle cut curves](https://github.com/AndreyKoudr/TCAD/blob/master/Shuttle_cut_curves.png)<br />
![Wing cut by curve](https://github.com/AndreyKoudr/TCAD/blob/master/Wing_cut_curve.png)<br />
- 2.7 Surfaces : triangles : find intersection of one set of triangles with another<br />
![Intersection curve](https://github.com/AndreyKoudr/TCAD/blob/master/Fuselage_fuselage.png)<br />
- 2.8 Surfaces : Bezier patch
- 2.9 Surfaces : Bezier surface, a composite of Bezier patches
- 2.10 Surfaces : point surface, a regular net of points with linear interpolation between
- 2.11 Surfaces : B-spline surface, interpolated and approximated, with and without clamping
- 2.12 Surfaces : intersection of two, get intersection curve and two parametric curves for trimming<br />
![Wing cylinder intersection](https://github.com/AndreyKoudr/TCAD/blob/master/Wing_cylinder.png)
- 2.13 Surfaces : intersect surface by plane, get intersection line and parametric curve for trimming
- 2.14 Surfaces : create B-spline surface from any other surface
- 2.15 Surfaces : make a trimmed B-spline surface from intersections by plane. Take the cut curve, close boundary and save this trimmed surface<br />
![Spline cut by plane and trimmed](https://github.com/AndreyKoudr/TCAD/blob/master/Spline_by_plane_trimmed.png)
- 2.16 Surfaces : make a trimmed B-spline surface from surface-surface intersection. Take the cut curve, close boundary and save this trimmed surface
- 2.17 Surfaces : make a hole (two loops) with trimmed B-spline surface<br />
![Wing cylinder trimmed](https://github.com/AndreyKoudr/TCAD/blob/master/Wing_cylinder_trimmed.png)
- 2.18 Surfaces : find parameters U,V for a point on (or close to) a surface

Volumes
=======

- 3.1 Volumes : create a Bezier volume around our wing, check definition of parametric values U,V,W for inner X,Y,Z points
- 3.2 Volumes : compare Bezier and B-spline based volume derivatives

Free form deformation (FFD)
===========================

- 4.1 FFD : distort wing shape by displacement of some points<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/FFD.png)

Blocks
======

- 5.1 Blocks : airfoil : preparing data to make an airfoil
- 5.2 Blocks : airfoil : how to make an airfoil from camber surface and thickness
- 5.3 Blocks : box : solid output
- 5.4 Blocks : blade<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/Blade.png)
- 5.5 Blocks : surfaces of revolution : propeller hub
- 5.6 Blocks : surfaces of revolution : propeller hub solid<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/Propeller_hub_solid.png)
- 5.7 Blocks : propeller, trimmed and solid<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/Kilo_propeller_solid_autodesk.png)
- 5.8 Blocks : submarine hull, axisymmetric solid<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/Submarine_hull_solid.png)
- 5.9 Blocks : attach propeller to submarine hull by shaft<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/Propeller_hull_connection.png)<br />
... with the result as propeller + hull + shaft solid<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/Propeller_hull_shaft_solid.png)
- 5.10 Blocks : submarine fin<br />
- 5.11 Blocks : submarine hull + propeller + fin, all single solid<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/Submarine_prop_hull_fin_solid.png)
- 5.12 Blocks : sub hump<br />
- 5.13 Blocks : submarine hull + propeller + fin + hump, all single solid<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/Kilo_with_hump_solid.png)
- 5.14 Blocks : filleted sub wings<br />
- 5.15 Blocks : sub with rudder<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/Kilo_with_hump_rudder_solid.png)

Booleans
=======================

- 6.0 B-reps : booleans, box and sphere
- 6.1 B-reps : booleans, box and sphere, union, subraction and intersection
- 6.2 B-reps : booleans, box and sphere, hard case (cutting along face edges)<br />
![FFD](https://github.com/AndreyKoudr/TCAD/blob/master/Booleans.png)

Important parameters in main.cpp
================================

main.cpp, see examples on how to use TCAD.<br />

<B>Set DEBUG_DIR for place to output of debug CAD files.</B><br />

<B>Also important :</B><br />

```

// default number of points used for output, linearisation etc.
#define MANY_POINTS 501

// default number of points for surface intersections etc.
#define MANY_POINTS2D 101 

// default number of points for volumes
#define MANY_POINTS3D 51 

// use space partitioning for speed
#define USE_SPACEPARTITIONING

// use threading for speed
#define USE_THREADS

// default number of threads
#define NUM_THREADS 8

```

Recent update ...
=================

Booleans, working. Back to submarine to apply booleans for cutting part of the rudder.<br /> 









